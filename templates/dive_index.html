<!DOCTYPE html>
<html lang="en">

<head>
    {%load static%}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <title>DASHGUM - FREE Bootstrap Admin Template</title>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="http://dive.nutn.edu.tw:8080/Experiment/js/DiVE.Linker.min.js"></script>
    <!-- Bootstrap core CSS -->
    <link href="{%static "assets/css/bootstrap.css "%}" rel="stylesheet">
    <!--external css-->
    <link href="{%static "assets/font-awesome/css/font-awesome.css "%}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{%static "assets/css/zabuto_calendar.css "%}">
    <link rel="stylesheet" type="text/css" href="{%static "assets/js/gritter/css/jquery.gritter.css "%}"/>
    <link rel="stylesheet" type="text/css" href="{%static "assets/lineicons/style.css "%}">
    <!-- Custom styles for this template -->
    <link href="{%static "assets/css/style.css "%}" rel="stylesheet">
    <link href="{%static "assets/css/style-responsive.css "%}" rel="stylesheet">
    <script src="{%static "assets/js/chart-master/Chart.js "%}"></script>
    <style type="text/css">
        p{font-size: 20px;}
    </style>
</head>

<body>
    <section id="container">
    {%block content%}
        <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
        <!--header start-->
        <header class="header black-bg">
            <div class="sidebar-toggle-box">
                <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
            </div>
            <!--logo start-->
            <a href="index.html" class="logo"><b>釀酒小實驗</b></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">
                <!--  notification start -->
                <!--  notification end -->
            </div>
            <div class="top-menu">
                <ul class="nav pull-right top-menu">
                    <li><a class="logout" href="/accounts/logout/">Logout</a></li>
                </ul>
            </div>
        </header>
        <!--header end-->
        <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
        <!--sidebar start-->
       <aside>
            <div id="sidebar" class="nav-collapse ">
                <!-- sidebar menu start-->
                <ul class="sidebar-menu" id="nav-accordion">
                    <h5 class="centered" style="margin-bottom: 0px;">{{user.username}}</h5>
                    <li class="mt" >
                        <a class="" href="/accounts/profile/">
                            <i class="fa fa-dashboard"></i>
                            <span>首頁-個人資料</span>
                        </a>
                    </li>
                    <li class="sub-menu" >
                        <a  href="/divelayout">
                            <i class="fa fa-desktop"></i>
                            <span>Dive釀酒小實驗</span>
                        </a>
                    </li>
                    <li class="sub-menu">
                        <a href="/questionask">
                            <i class="fa fa-tasks"></i>
                            <span>題目測驗</span>
                        </a>
                    </li>
                    <li class="sub-menu">
                      <a href="/brewwine" >
                          <span>釀酒步驟方法</span>
                      </a>
                    </li>
                    <li class="sub-menu">
                      <a href="/bartenderstory" >
                          <span>Bartender小故事</span>
                      </a>
                    </li>
                    <li class="sub-menu">
                        <a href="/lmessage_layout">
                            <i class="fa fa-book"></i>
                            <span>留言板</span>
                        </a>
                    </li>
                    <li class="sub-menu">
                      <a href="/divescorelayout" >
                          <span>實驗成績</span>
                      </a>
                    </li>
                    <li class="sub-menu">
                      <a href="/testscorelayout" >
                          <span>題目成績</span>
                      </a>
                    </li>
                </ul>
                <!-- sidebar menu end-->
            </div>
        </aside>
        <!--sideba
        <!--sidebar end-->
        <!-- **********************************************************************************************************************************************************
      MAIN CONTENT
      *********************************************************************************************************************************************************** -->
        <!--main content start-->

        <section id="main-content">
            <section class="wrapper">
                <div class="row">
                    <div class="col-lg-8 main-chart">

                       <iframe src="http://dive.nutn.edu.tw:8080/Experiment/kaleTestExperiment4.jsp?eid=2923" id="mainExperiment" name="mainExperiment" style="width: 1024px; height: 768px;transform: scale(0.7);-webkit-transform-origin-x: 70%;-webkit-transform-origin-y: 0%;
    position: absolute;transform-origin: 10% 0%;" ></iframe>
                        <div id="player" style="display:none; width: 1024px; height: 768px;transform: scale(0.7);-webkit-transform-origin-x: 70%;-webkit-transform-origin-y: 0%;
    position: absolute;transform-origin: 10% 0%;padding-bottom: 30px; "></div>
                        <div id="player2" style="display:none; width: 1024px; height: 768px;transform: scale(0.7);-webkit-transform-origin-x: 70%;-webkit-transform-origin-y: 0%;
    position: absolute;transform-origin: 10% 0%;padding-bottom: 30px; "></div>
                        <iframe src="http://dive.nutn.edu.tw:8080/Experiment/kaleTestExperiment4.jsp?eid=2933" id="newIframe" name="mainExperiment" style="width: 1024px; height: 768px;transform: scale(0.7);-webkit-transform-origin-x: 70%;-webkit-transform-origin-y: 0%;
    position: absolute;transform-origin: 10% 0%;opacity: 0 ; z-index: -1;" ></iframe>

                    <!--內容填寫-->
                    </div>
                    <div class="col-lg-4 main-chart">
                        <div style="width:100%;height: 100%; background-color: #424A5D; padding: 30px; box-sizing: border-box;color: white;">
                            <h2 id="scoreuser">SCORE：</h2>
                            <button id="savescore" style="width:100%;font-size:20px;background: #1AAE85;padding: 20px; border: none; margin: 20px 0;">GET SCORE/AND SAVE</button>
                            <form role="form" method="POST" >
                                {% csrf_token %} 
                                <textarea id="textmessage" name="Text1" cols="45" rows="10" style="border: 1px solid white; background: inherit;"></textarea>
                            </form>
                            <button id="buttoncomment" style="width:100%;font-size:20px;background: #1AAE85;padding: 20px; border: none; margin: 20px 0;" type="submit">SEND COMMENT</button>
                        </div>
                    </div>
                </div>
                <! --/row -->
            </section>
        </section>
    </section>
    <script src="{%static "assets/js/jquery.js "%}"></script>
    <script src="{%static "assets/js/jquery-1.8.3.min.js "%}"></script>
    <script src="{%static "assets/js/bootstrap.min.js "%}"></script>
    <script class="include" type="text/javascript" src="{%static "assets/js/jquery.dcjqaccordion.2.7.js "%}"></script>
    <script src="{%static "assets/js/jquery.scrollTo.min.js "%}"></script>
    <script src="{%static "assets/js/jquery.nicescroll.js "%}" type="text/javascript"></script>
    <script src="{%static "assets/js/jquery.sparkline.js "%}"></script>
    <!--common script for all pages-->
    <script src="{%static "assets/js/common-scripts.js "%}"></script>
    <script type="text/javascript" src="{%static "assets/js/gritter/js/jquery.gritter.js "%}"></script>
    <script type="text/javascript" src="{%static "assets/js/gritter-conf.js "%}"></script>
    <!--script for this page-->
    <script src="{%static "assets/js/sparkline-chart.js "%}"></script>
    <script src="{%static "assets/js/zabuto_calendar.js "%}"></script>
    
    <script type="text/javascript">
        var iframe=document.getElementById("mainExperiment");
        var pvalue=document.getElementById("pvalue");
        var newIframe=document.getElementById("newIframe");
        var myVar = setInterval(myTimer, 5000);
        var myScore=setInterval(myScoreuser,1000);
        var playerdetect=setInterval(onYouTubeIframeAPIReady,1000);
        function myScoreuser(){
            var score=diveLinker.Get(1495898848617);
            document.getElementById("scoreuser").innerHTML="Score："+score;
            document.getElementById("scoreuser").value=score;
        }
        function myTimer() {
            var d = diveLinker.Get(1496285913119);
            if(d==1){
                clearInterval(myVar);
                iframe.remove();
                $('#player').show(); 
                player.playVideo();
            }   
        }
        function Sendcomment(){
            diveLinker.Send(1496594880436,1);
            diveLinker.Send(1495991764213,0);
        }
        var tag = document.createElement('script');
        tag.src = "http://www.youtube.com/player_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        var player;
        var player2;
        function onYouTubePlayerAPIReady() {
            player = new YT.Player('player', {
                height: '768',
                width: '1024',
                videoId: 'Rw5zOgpooVo',
                playerVars: {'rel': 0, 'showinfo': 0, 'egm': 0, 'showsearch': 0, 'start':89 ,'end':299 },
                events:{
                    'onStateChange':onPlayerStateChange1
                }
            });
            player2 = new YT.Player('player2', {
                height: '768',
                width: '1024',
                videoId: 'qIehYVczIlo',
                playerVars: {'rel': 0, 'showinfo': 0, 'egm': 0, 'showsearch': 0, 'start':428 ,'end':570 },
                events: {
                    'onStateChange': onPlayerStateChange2
                }
            });
        }
        function onPlayerStateChange1(event) {
            //When the video has ended
            if (event.data == YT.PlayerState.ENDED) {
                event.target.destroy();
                $("#player2").show();
                player2.playVideo();
            }
        }

        function onPlayerStateChange2(event) {
            //When the video has ended
            if (event.data == YT.PlayerState.ENDED) {
                event.target.destroy();
                document.getElementById("newIframe").style.opacity="1";
                document.getElementById("newIframe").style.zIndex="";
            }
        }
        
        
    </script>
    <script type="text/javascript">
        $(function () {
            $('#savescore').on('click', function () {
                $.ajax({
                    type:'POST',
                    url: '/divescore/',
                    data: {
                        user:'{{user.username}}',
                        score: $("#scoreuser").val(),
                    },
                    success:function(){
                        alert("您的成績已送出，可以到實驗成績觀看唷！");
                    }
                });
            });
        });
    </script>
    <script type="text/javascript">
        $(function () {
            $('#buttoncomment').on('click', function () {
                $.ajax({
                    type:'POST',
                    url: '/lmessage/',
                    data: {
                        user:'{{user.username}}',
                        comment: $("textarea[id=textmessage]").val(),
                    },
                    success:function(){
                        alert("您輸入資料已送出，可以到留言板觀看！");
                    }
                });
            });
        });
    </script>
    <script type="text/javascript" src="http://www.youtube.com/player_api"></script>
    {%endblock%}
</body>

</html>
